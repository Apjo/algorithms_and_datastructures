package prep.amz.oa;

import java.util.ArrayList;
import java.util.List;
import java.util.PriorityQueue;
/*
Amazon Web Services has n servers where the ith server's vulnerability score is vulnerability[i]. A client wants to deploy their application on a group of m contiguous servers. The vulnerability of a group is defined as the kth minimum vulnerability among the chosen servers. Find the vulnerability of each possible group of m contiguous servers the client can choose.

Function Description

Complete the function findKthMinimumVulnerability in the editor below.

findKthMinimumVulnerability has the following parameter(s):

int k: the order of the vulnerability to find
int m: the number of servers in a group
int vulnerability[n]: the vulnerabilities of each server
Returns

int[]: the vulnerabilities for each group, in order

Example 1:

Input: k = 2, m = 3, vulnerability = [1, 3, 2, 1]
Output: [2, 2]
Explanation:

There are 2 contiguous groups of m = 3 servers: [1, 3, 2] and [3, 2, 1].

The k = 2nd lowest vulnerability in each group is 2.

Return the answers for each group, in order: [2, 2].
 */
public class KthMinVulnerability {

    public int[] findKthMinimumVulnerability(int k, int m, int[] vulnerability) {
        List<Integer> res = new ArrayList<>();
        int N = vulnerability.length;
        PriorityQueue<Integer> maxH = new PriorityQueue<>((a, b) -> Integer.compare(b, a));
        for(int i=0; i < N; i++) {
            maxH.offer(vulnerability[i]);
            if (i >=m) {
                maxH.remove(vulnerability[i - m]);
            }
            if (maxH.size() > k) {
                maxH.poll();
            }
            if (i >= m - 1) {
                res.add(maxH.peek());
            }
        }
        return res.stream().mapToInt(i->i).toArray();
    }

    public static void main(String[] args) {
    }
}
